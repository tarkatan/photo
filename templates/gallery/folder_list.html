{% extends 'base.html' %}
{% block content %}
<h2>–ú–æ—ó –ø–∞–ø–∫–∏</h2>
<div>
    <h3>–í–ª–∞—Å–Ω—ñ –ø–∞–ø–∫–∏</h3>
    {% for folder in owned_folders %}
    <div class="folder">
        <div class="folder-icon">üìÅ</div>
        <div><a href="{% url 'folder_detail' folder.id %}">{{ folder.name }}</a></div>
        <div>
            <form method="post" action="{% url 'delete_folder' folder.id %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn">–í–∏–¥–∞–ª–∏—Ç–∏</button>
            </form>
            <a href="{% url 'share_folder' folder.id %}" class="btn">–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è</a>
        </div>
    </div>
    {% empty %}
    <p>–ù–µ–º–∞—î –≤–ª–∞—Å–Ω–∏—Ö –ø–∞–ø–æ–∫.</p>
    {% endfor %}
</div>

<div>
    <h3>–°–ø—ñ–ª—å–Ω—ñ –ø–∞–ø–∫–∏</h3>
    {% for folder in shared_folders %}
    <div class="folder">
        <div class="folder-icon">üìÅ</div>
        <div>
            <strong>–°–ø—ñ–ª—å–Ω–∞ –ø–∞–ø–∫–∞:</strong> {{ folder.name }}
        </div>
        <div>
            <p>–ó –≤–∞–º–∏ –ø–æ–¥—ñ–ª–∏–ª–∏—Å—è: 
              {% for share in folder.shares.all %}
                {{ share.shared_by.username }}{% if not forloop.last %}, {% endif %}
              {% empty %}
                –Ω–µ–≤—ñ–¥–æ–º–æ
              {% endfor %}
            </p>
            <a href="{% url 'folder_detail' folder.id %}" class="btn">–í—ñ–¥–∫—Ä–∏—Ç–∏</a>
        </div>
    </div>
    {% empty %}
    <p>–ù–µ–º–∞—î —Å–ø—ñ–ª—å–Ω–∏—Ö –ø–∞–ø–æ–∫.</p>
    {% endfor %}
</div>

<div>
    <h3>–ú–æ—ó –≤—ñ–ª—å–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è</h3>
    {% for image in free_images %}
      <div class="image">
          <img src="{{ image.image_url }}" alt="Image">
          <div>
              <form method="post" action="{% url 'delete_image' image.id %}" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn">–í–∏–¥–∞–ª–∏—Ç–∏</button>
              </form>
              <a href="{% url 'share_image' image.id %}" class="btn">–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è</a>
          </div>
      </div>
    {% empty %}
      <p>–ù–µ–º–∞—î –≤—ñ–ª—å–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å.</p>
    {% endfor %}
</div>

<div>
    <h3>–°–ø—ñ–ª—å–Ω—ñ —Ñ–æ—Ç–æ</h3>
    {% for image in shared_images %}
      <div class="image">
          <img src="{{ image.image_url }}" alt="Image">
          <p>
            <strong>–°–ø—ñ–ª—å–Ω–µ —Ñ–æ—Ç–æ</strong><br>
            –ó –≤–∞–º–∏ –ø–æ–¥—ñ–ª–∏–ª–∏—Å—è: 
            {% for share in image.shares.all %}
              {{ share.shared_by.username }}{% if not forloop.last %}, {% endif %}
            {% empty %}
              –Ω–µ–≤—ñ–¥–æ–º–æ
            {% endfor %}
          </p>
          {% if image.folder and image.folder_shared %}
            <a href="{% url 'folder_detail' image.folder.id %}" class="btn">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤ –ø–∞–ø—Ü—ñ</a>
          {% endif %}
      </div>
    {% empty %}
      <p>–ù–µ–º–∞—î —Å–ø—ñ–ª—å–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å.</p>
    {% endfor %}
</div>

<h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –ø–∞–ø–∫—É</h3>
<form method="post">
    {% csrf_token %}
    {{ root_folder_form.as_p }}
    <button type="submit" name="create_root_folder" class="btn">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
</form>
{% endblock %}
